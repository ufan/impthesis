% vim:ts=4:sw=4
%
% Copyright (c) 2008-2009 solvethis
% Copyright (c) 2010-2015 Casper Ti. Vector
% Public domain.
%
% 使用前请先仔细阅读 impthss 和 biblatex-caspervector 的文档，
% 特别是其中的 FAQ 部分和用红色强调的部分。
% 两者可在终端/命令提示符中用
%   texdoc impthss
%   texdoc biblatex-caspervector
% 调出。

% 采用了自定义的（包括大小写不同于原文件的）字体文件名，
% 并改动 ctex.cfg 等配置文件的用户请自行加入 nofonts 选项；
% 其它用户不用加入 nofonts 选项，加入之后反而会产生错误。
%
% 图书馆要求电子版论文的目录必须为黑色，
% 且某些教务要求打印版论文的文字部分为纯黑色而非灰度打印，
% 【因此最终打印和提交论文前，请将“colorlinks”改为“nocolorlinks”。】
\documentclass[UTF8, nocolorlinks, openany, spacing, pdftoc, pkuspace]{impthss}
% 设置行距为1.5。ctex说明文档中说linespread也可以作为选项传入，但测试结果显示不起效果。
% 因此在此处显示调用\linespread命令设置行距，测试显示有效果。
\linespread{1.5}
% 使用 biblatex 排版参考文献，并规定其格式（详见 biblatex-caspervector 的文档）。
% 这里按照英文文献在前，中文文献在后排序（“sorting = ecnty”）；
% 若需按照中文文献在前，英文文献在后排序，请设置“sorting = centy”；
% 若需按照引用顺序排序，请设置“sorting = none”。
\usepackage[backend = biber, style = caspervector, utf8, sorting = none]{biblatex}
% 提供近似于学校所要求的 Times New Roman / Arial 的字体。
\usepackage[defaultsups]{newtxtext}
\usepackage{newtxmath}
% 产生 originauth.tex 里的 \square。
\usepackage{latexsym}

% 按学校要求设定参考文献列表中的条目之内及之间的距离。
\setlength{\bibitemsep}{3bp}
% 对于 linespread 值的计算过程有兴趣的同学可以参考 impthss-extra.sty。
\renewcommand*{\bibfont}{\zihao{5}\linespread{1.27}\selectfont}

% 设定文档的基本信息。
% \ctexset{today=big}
\impthssinfo{
	cthesisname = {博士研究生学位论文}, ethesisname = {Doctor Thesis},
	ctitle = {用于空间暗物质探测的塑闪阵列探测器的设计与研制},
	etitle = {Doctor Thesis \LaTeX{} Template for the Institute of Modern Physics of Chineses Academy of Sciences},
	cauthor = {周勇},
	eauthor = {Zhou Yong},
	studentid = {0123456789},
	date = {\today},
	school = {中国科学院大学研究生院},
	cmajor = {粒子物理与原子核物理}, emajor = {Nuclear and Particle Physics},
	direction = {实验核物理},
	cmentor = {孙志宇教授}, ementor = {Prof.\ Sun Zhiyu},
	ckeywords = {其一，其二}, ekeywords = {KeywdOne, KeywdTwo}
}
% 载入参考文献数据库（注意不要省略“.bib”）。
%\addbibresource{thesis.bib}
\addbibresource{./refs/ch2.bib}
\addbibresource{./refs/ch3.bib}
\addbibresource{./refs/ch4.bib}

% extra packages
\usepackage[absolute, overlay]{textpos} %封面制作
% \usepackage{import} % 使用\import,\subimport命令模块化文档结构，可以用相对路径载入文档
\usepackage{blindtext}
\usepackage{comment}
\usepackage{siunitx}
\usepackage{float}
\usepackage{mdwlist}
% \usepackage{subcaption} //error
% 表格内角注
\usepackage{threeparttable}
\AtBeginEnvironment{tablenotes}{\small}{}{}
% 设置表格字体大小
\usepackage[font=normalsize]{caption}
\let\oldtabular\tabular 
\renewcommand{\tabular}{\small\oldtabular}

\raggedbottom
\begin{comment}
	\usepackage{etoolbox}
	\newskip\mfilskip
	\mfilskip=0pt plus 3cm\relax
	\newcommand{\mfilbreak}{\vspace{\mfilskip}\penalty -200%
	\ifdim\lastskip<\mfilskip\vspace{-\lastskip}\else\vspace{-\mfilskip}\fi}
	\pretocmd{\section}{\mfilbreak}{}{}content...
\end{comment}

% 处理tiff图片
% \usepackage{grfext}
% \DeclareGraphicsRule{.tif}{png}{.png}%
% {%
  % `convert #1 `dirname #1`/`basename #1 .tif`-tif-converted-to.png %
% }

% \includeonly{./chap/introduction/introduction}
% \includeonly{./chap/description/description}
% \includeonly{./chap/dynamic_range/dynamic_range}
\includeonly{./chap/introduction/introduction,./chap/description/description,./chap/dynamic_range/dynamic_range,./chap/pmt_test/pmt_test,./chap/construction/construction,./chap/appendix/app1}
\begin{document}
	%%%%%%%%%%%%%%%%%%%%%%%%%
	%%% 封面,版权,声明,致谢 %%%
	\covermatter
	% 自动生成封面。
%	\maketitle
	% 从pdf载入封面
 	\input{cover/cover_cn.tex}
 	\null\newpage
 	\input{cover/cover_en.tex}
 	\null\newpage

	% 版权声明。
	\input{cover/copyright}
	% 原创性声明和使用授权说明。
	\input{cover/originauth}
	% 致谢。
	\input{./chap/acknowledge/acknowledge}
	
	%%%%%%%%%%%%%%%%%%%%%
	%%% 中英文摘要,目录 %%%
	% 简单页眉页脚.此后内容都加入目录,并双面打印
	\frontmatter
	% 中英文摘要。
	\input{./chap/abstract/abstract}
	% 自动生成目录。	
	\tableofcontents

	%%%%%%%%%%%%%%%%%
	%%% 正文各章节 %%%
	\mainmatter
	% 各章节。
	\include{./chap/introduction/introduction}
	% 各章节。
	\include{./chap/description/description}
	% 各章节
	\include{./chap/dynamic_range/dynamic_range}
	% 各章节。
	\include{./chap/pmt_test/pmt_test}
	% 各章节。
	\include{./chap/construction/construction}
	%
	\include{chap/cosmic_ray/cosmic_ray}
	% 各章节。
	\include{chap/heavy_ion/heavy_ion}
	% 结论
	\include{chap/conclusion/conclusion}

	% special chapter没有章节编号，在目录中显示
% 	\subimport*{chap/special}{}
	% 正文中的附录部分。
	\appendix
	% 排版参考文献列表。
	\printbibliography[
		% 使“参考文献”出现在目录中；如果同时要使参考文献列表参与章节编号，
		% 可将“bibintoc”改为“bibnumbered”。
		heading = bibintoc,
		% 单独设定排序方案。此设定会局部覆盖之前的全局设置。
		% 注：只有同时使用 2.x 或之后版本的 biblatex 和相应兼容版本的 biber，
		% 才能对每个 \printbibliography 命令采用不同的排序方案，
		% 否则只能在载入 biblatex 宏包时就（全局）指定排序方案。
		% 在这样的情况下，请去掉所有的 sorting 选项，否则可能出错。
		% 此外，biblatex 3.0 中 \printbibliography 的 sorting 选项失效，
		% 详见 biblatex-caspervector 的文档。
		sorting = ecnty
	]
	% 各附录。
	\include{./chap/appendix/app1}
	%\include{./chap/appendix/app2}
	
	
	% 以下为正文之后的部分，默认不进行章节编号。
	\backmatter
	
\end{document}

